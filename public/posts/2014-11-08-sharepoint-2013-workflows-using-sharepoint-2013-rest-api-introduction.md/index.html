<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>SharePoint 2013 Workflows - Using The SharePoint 2013 REST API: Introduction | sjoukje.eth</title>
<meta name="keywords" content="">
<meta name="description" content="In this series of posts I will focus on leveraging the Out-of-the-Box SharePoint REST API in visual studio workflows.
I will provide some samples on how to use this REST API, which includes making calls to the REST Services as well as retrieving Security Tokens to authenticate to SharePoint.
Besides that I will create some Custom Activities which can be downloaded and used in your own SharePoint Workflow projects.
The following topics are included in this series:">
<meta name="author" content="sjoukje.eth">
<link rel="canonical" href="//localhost:1313/posts/2014-11-08-sharepoint-2013-workflows-using-sharepoint-2013-rest-api-introduction.md/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.36f09b336921909a5971cfa84422229fa3edb550fa46b7707cb5436b0983bdcf.css" integrity="sha256-NvCbM2khkJpZcc&#43;oRCIin6PttVD6RrdwfLVDawmDvc8=" rel="preload stylesheet" as="style">
<link rel="icon" href="//localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="//localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="//localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="//localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="//localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="//localhost:1313/posts/2014-11-08-sharepoint-2013-workflows-using-sharepoint-2013-rest-api-introduction.md/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="//localhost:1313/posts/2014-11-08-sharepoint-2013-workflows-using-sharepoint-2013-rest-api-introduction.md/">
  <meta property="og:site_name" content="sjoukje.eth">
  <meta property="og:title" content="SharePoint 2013 Workflows - Using The SharePoint 2013 REST API: Introduction">
  <meta property="og:description" content="In this series of posts I will focus on leveraging the Out-of-the-Box SharePoint REST API in visual studio workflows.
I will provide some samples on how to use this REST API, which includes making calls to the REST Services as well as retrieving Security Tokens to authenticate to SharePoint.
Besides that I will create some Custom Activities which can be downloaded and used in your own SharePoint Workflow projects.
The following topics are included in this series:">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2014-11-08T00:00:00+00:00">
    <meta property="article:modified_time" content="2014-11-08T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SharePoint 2013 Workflows - Using The SharePoint 2013 REST API: Introduction">
<meta name="twitter:description" content="In this series of posts I will focus on leveraging the Out-of-the-Box SharePoint REST API in visual studio workflows.
I will provide some samples on how to use this REST API, which includes making calls to the REST Services as well as retrieving Security Tokens to authenticate to SharePoint.
Besides that I will create some Custom Activities which can be downloaded and used in your own SharePoint Workflow projects.
The following topics are included in this series:">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "//localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "SharePoint 2013 Workflows - Using The SharePoint 2013 REST API: Introduction",
      "item": "//localhost:1313/posts/2014-11-08-sharepoint-2013-workflows-using-sharepoint-2013-rest-api-introduction.md/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "SharePoint 2013 Workflows - Using The SharePoint 2013 REST API: Introduction",
  "name": "SharePoint 2013 Workflows - Using The SharePoint 2013 REST API: Introduction",
  "description": "In this series of posts I will focus on leveraging the Out-of-the-Box SharePoint REST API in visual studio workflows.\nI will provide some samples on how to use this REST API, which includes making calls to the REST Services as well as retrieving Security Tokens to authenticate to SharePoint.\nBesides that I will create some Custom Activities which can be downloaded and used in your own SharePoint Workflow projects.\nThe following topics are included in this series:\n",
  "keywords": [
    
  ],
  "articleBody": "In this series of posts I will focus on leveraging the Out-of-the-Box SharePoint REST API in visual studio workflows.\nI will provide some samples on how to use this REST API, which includes making calls to the REST Services as well as retrieving Security Tokens to authenticate to SharePoint.\nBesides that I will create some Custom Activities which can be downloaded and used in your own SharePoint Workflow projects.\nThe following topics are included in this series:\nSharePoint 2013 Workflows - Using The SharePoint 2013 REST API: Introduction\nSharePoint 2013 Workflows – Retrieving a Security Digest for your Workflow\nSharePoint 2013 Workflows - Using The SharePoint 2013 REST API Part 2: Creating a List item In this post I will create a Custom Workflow in Visual Studio that uses the SharePoint REST API to create a new list item in a SharePoint site.\nIn this scenario a List item is created in a vacation requests list. After creating the request item, the workflow is automatically triggered to create a copy of this item in the Approved Vacation Requests list.\nBoth the lists and the workflow are created as an app in SharePoint. For creating an item in the Approved Vacation list the SharePoint REST API is leveraged in the custom Workflow.\nIn a real world scenario, the request probably will need to be approved or rejected by a manager, but for this demo this step is not required because I only want to show how to use the REST API in a workflow.\nSetting Up the Visual Studio Project Create a new Visual Studio Project, choose the App for SharePoint project and give it a name.\nSelect SharePoint-Hosted app and fill in a SharePoint Development Site Url.\nAfter the project is created, add a new list to the project. Call the list VacationRequests. Add another list to the project and call it ApprovedVacationRequests.\nAdd the below fields to both the Vacation Request and the ApprovedVacationRequests list.\nChange the start page for the App to point to the default Url of the Vacation Request list. Open the AppManifest.xml and change the start page.\nThe last step for setting up the project is to add a workflow. Name it CreateListItemWorkflow.\nIn the next screen select List Workflow, click next and select the Vacation Requests list to associate the workflow to. Create a new History and Task list.\nSelect the option that the workflow automatically needs be started when an item is created.\nThe workflow is created and the below items are added to the project.\nCreating the Workflow So now the project is created the next step is to create the actual Workflow. First I will add a few variables I will need throughout the project:\nRequest Title : Type String\nFirst_Date_Of_Leave : Type String\nLast_Date_Of_Leave : Type String\nAdditional_Information : Type String\nGet ListItem Properties Add an Sequence activity to the Root Activity and call it Get Vacation Request Properties. Add a SetUserStatus Activity to the sequence and add the description: Collecting Data from the List Item. The SetUserStatus will create an internal status property which will be displayed on the Workflow Status Page.\nAdd a LookUpSPListItem activity below the SetUserStatus Activity and create a new variable ListRequestItemProperties of the type DynamicValue. This type is referenced in the Microsoft Activity Assembly under Microsoft Activities -\u003e DynamicValue.\nThe DynamicValue is a new data type which understands JSON, so when you make a call to a WCF using the HTTP Send Activity, it return s an object of the type DynamicValue. You can then use an activity to extract data from this variables using an XPATH Expression.\nRename the LookUpSPListItem to Get List Item Request Properties and add the following properties:\nItemId = (currentitem)\nListId = (currentlist)\nResult = ListRequestItemProperties\nAdd an GetDynamicValueProperties Activity, call it Extract ListItem Properties and add the ListRequestItemProperties as the source in the property pane. Click on the ellipsis button next to properties and add the items to the properties box like the items in the below figure:\nAdd a WriteToHistory Activity and add the message provided below:\nCreate the new List Item Now we can create a new list item in the Approved Vacation Request list using the REST API.\nAdd a new Sequence to the Root and call it Create List item. Create the following variables:\nCreateListRequestPayLoad : Type DynamicValue\nCreateListResponseBody: Type DynamicValue\nAppWebUrl : Type String\nAdd a WebUri Activity to the sequence and call it GetAppWebUrl. Select the AppWebUrl as the result in the property pane.\nAdd a SetUserStatus Activity and the following description: [\"Create a list item in the]{.mark} Approved Vacation List\".\nTo Create the new list item we need to create the payload we are going to send to the REST API using JSON. Add a BuildDynamicValue Activity and add the following properties:\nDisplayName: Create new List Item Payload\nResult: [CreateListRequestPayLoad]{.mark}\nProperties\nAdd an HTTPSend Activity and add the following properties:\nDisplayName: Create List Item\nMethod: POST\nRequest Content: [CreateListRequestPayLoad]{.mark}\nRequest Headers: Add the following request header:\nAccept: “application/json;odata=verbose”\nContent-Type: “application/json;odata=verbose”\nUri: [AppWebUrl + \"_api/web/lists/GetByTitle(‘ApprovedVacationRequests')/items\"]{.mark}\nResponseContent: [CreateListResponseBody]{.mark}\nFigure 21: Workflow Model.\nDeploying the Workflow Now that the workflow is finished we can deploy it to SharePoint. Click F5. Add a new Vacation Request to the list and Click Save.\n",
  "wordCount" : "877",
  "inLanguage": "en",
  "datePublished": "2014-11-08T00:00:00Z",
  "dateModified": "2014-11-08T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "sjoukje.eth"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "//localhost:1313/posts/2014-11-08-sharepoint-2013-workflows-using-sharepoint-2013-rest-api-introduction.md/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "sjoukje.eth",
    "logo": {
      "@type": "ImageObject",
      "url": "//localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="//localhost:1313/" accesskey="h" title="sjoukje.eth (Alt + H)">sjoukje.eth</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="//localhost:1313/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/books/" title="Books">
                    <span>Books</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="//localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="//localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="//localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      SharePoint 2013 Workflows - Using The SharePoint 2013 REST API: Introduction
    </h1>
    <div class="post-meta"><span title='2014-11-08 00:00:00 +0000 UTC'>November 8, 2014</span>&nbsp;·&nbsp;<span>5 min</span>&nbsp;·&nbsp;<span>sjoukje.eth</span>

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#sharepoint-2013-workflows---using-the-sharepoint-2013-rest-api-part-2-creating-a-list-item" aria-label="SharePoint 2013 Workflows - Using The SharePoint 2013 REST API Part 2: Creating a List item">SharePoint 2013 Workflows - Using The SharePoint 2013 REST API Part 2: Creating a List item</a><ul>
                        
                <li>
                    <a href="#setting-up-the-visual-studio-project" aria-label="Setting Up the Visual Studio Project">Setting Up the Visual Studio Project</a></li>
                <li>
                    <a href="#creating-the-workflow" aria-label="Creating the Workflow">Creating the Workflow</a><ul>
                        
                <li>
                    <a href="#get-listitem-properties" aria-label="Get ListItem Properties">Get ListItem Properties</a></li>
                <li>
                    <a href="#create-the-new-list-item" aria-label="Create the new List Item">Create the new List Item</a></li>
                <li>
                    <a href="#deploying-the-workflow" aria-label="Deploying the Workflow">Deploying the Workflow</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>In this series of posts I will focus on leveraging the Out-of-the-Box SharePoint REST API in visual studio workflows.</p>
<p>I will provide some samples on how to use this REST API, which includes making calls to the REST Services as well as retrieving Security Tokens to authenticate to SharePoint.</p>
<p>Besides that I will create some Custom Activities which can be downloaded and used in your own SharePoint Workflow projects.</p>
<p>The following topics are included in this series:</p>
<ol>
<li>
<p>SharePoint 2013 Workflows - Using The SharePoint 2013 REST API: Introduction</p>
</li>
<li>
<p>SharePoint 2013 Workflows &ndash; Retrieving a Security Digest for your Workflow</p>
</li>
</ol>
<h1 id="sharepoint-2013-workflows---using-the-sharepoint-2013-rest-api-part-2-creating-a-list-item">SharePoint 2013 Workflows - Using The SharePoint 2013 REST API Part 2: Creating a List item<a hidden class="anchor" aria-hidden="true" href="#sharepoint-2013-workflows---using-the-sharepoint-2013-rest-api-part-2-creating-a-list-item">#</a></h1>
<p>In this post I will create a Custom Workflow in Visual Studio that uses the SharePoint REST API to create a new list item in a SharePoint site.</p>
<p>In this scenario a List item is created in a vacation requests list. After creating the request item, the workflow is automatically triggered to create a copy of this item in the Approved Vacation Requests list.</p>
<p>Both the lists and the workflow are created as an app in SharePoint. For creating an item in the Approved Vacation list the SharePoint REST API is leveraged in the custom Workflow.</p>
<p>In a real world scenario, the request probably will need to be approved or rejected by a manager, but for this demo this step is not required because I only want to show how to use the REST API in a workflow.</p>
<h2 id="setting-up-the-visual-studio-project">Setting Up the Visual Studio Project<a hidden class="anchor" aria-hidden="true" href="#setting-up-the-visual-studio-project">#</a></h2>
<p>Create a new Visual Studio Project, choose the <strong>App for SharePoint</strong> project and give it a name.</p>
<p>Select <strong>SharePoint-Hosted</strong> app and fill in a SharePoint Development Site Url.</p>
<p>After the project is created, add a new list to the project. Call the list <strong>VacationRequests.</strong> Add another list to the project and call it <strong>ApprovedVacationRequests.</strong></p>
<p>Add the below fields to both the <strong>Vacation Request</strong> and the <strong>ApprovedVacationRequests</strong> list.</p>
<p>Change the start page for the App to point to the default Url of the <strong>Vacation Request</strong> list. Open the <strong>AppManifest.xml</strong> and change the start page.</p>
<p>The last step for setting up the project is to add a workflow. Name it <strong>CreateListItemWorkflow</strong>.</p>
<p>In the next screen select <strong>List Workflow</strong>, click next and select the Vacation Requests list to associate the workflow to. Create a new History and Task list.</p>
<p>Select the option that the workflow automatically needs be started when an item is created.</p>
<p>The workflow is created and the below items are added to the project.</p>
<h2 id="creating-the-workflow">Creating the Workflow<a hidden class="anchor" aria-hidden="true" href="#creating-the-workflow">#</a></h2>
<p>So now the project is created the next step is to create the actual Workflow. First I will add a few variables I will need throughout the project:</p>
<p>Request Title : Type String</p>
<p>First_Date_Of_Leave : Type String</p>
<p>Last_Date_Of_Leave : Type String</p>
<p>Additional_Information : Type String</p>
<h3 id="get-listitem-properties">Get ListItem Properties<a hidden class="anchor" aria-hidden="true" href="#get-listitem-properties">#</a></h3>
<p>Add an Sequence activity to the Root Activity and call it <strong>Get Vacation Request Properties.</strong> Add a <strong>SetUserStatus</strong> Activity to the sequence and add the description: <strong>Collecting Data from the List Item.</strong> The <strong>SetUserStatus</strong> will create an internal status property which will be displayed on the Workflow Status Page.</p>
<p>Add a <strong>LookUpSPListItem</strong> activity below the SetUserStatus Activity and create a new variable <strong>ListRequestItemProperties</strong> of the type DynamicValue. This type is referenced in the Microsoft Activity Assembly under Microsoft Activities -&gt; DynamicValue.</p>
<p>The DynamicValue is a new data type which understands JSON, so when you make a call to a WCF using the HTTP Send Activity, it return s an object of the type DynamicValue. You can then use an activity to extract data from this variables using an XPATH Expression.</p>
<p>Rename the <strong>LookUpSPListItem</strong> to <strong>Get List Item Request Properties</strong> and add the following properties:</p>
<ul>
<li>
<p>ItemId = (currentitem)</p>
</li>
<li>
<p>ListId = (currentlist)</p>
</li>
<li>
<p>Result = ListRequestItemProperties</p>
</li>
</ul>
<p>Add an <strong>GetDynamicValueProperties</strong> Activity, call it <strong>Extract ListItem Properties</strong> and add the ListRequestItemProperties as the source in the property pane. Click on the ellipsis button next to properties and add the items to the properties box like the items in the below figure:</p>
<p>Add a <strong>WriteToHistory Activity</strong> and add the message provided below:</p>
<h3 id="create-the-new-list-item">Create the new List Item<a hidden class="anchor" aria-hidden="true" href="#create-the-new-list-item">#</a></h3>
<p>Now we can create a new list item in the Approved Vacation Request list using the REST API.</p>
<p>Add a new Sequence to the Root and call it <strong>Create List item.</strong> Create the following variables:</p>
<ul>
<li>
<p>CreateListRequestPayLoad : Type DynamicValue</p>
</li>
<li>
<p>CreateListResponseBody: Type DynamicValue</p>
</li>
<li>
<p>AppWebUrl : Type String</p>
</li>
</ul>
<p>Add a WebUri Activity to the sequence and call it <strong>GetAppWebUrl.</strong> Select the AppWebUrl as the result in the property pane.</p>
<p>Add a SetUserStatus Activity and the following description: [&quot;Create a list item in the]{.mark} Approved Vacation List&quot;.</p>
<p>To Create the new list item we need to create the payload we are going to send to the REST API using JSON. Add a BuildDynamicValue Activity and add the following properties:</p>
<ul>
<li>
<p>DisplayName: Create new List Item Payload</p>
</li>
<li>
<p>Result: [CreateListRequestPayLoad]{.mark}</p>
</li>
<li>
<p>Properties</p>
</li>
</ul>
<p>Add an <strong>HTTPSend</strong> Activity and add the following properties:</p>
<ul>
<li>
<p>DisplayName: Create List Item</p>
</li>
<li>
<p>Method: POST</p>
</li>
<li>
<p>Request Content: [CreateListRequestPayLoad]{.mark}</p>
</li>
<li>
<p>Request Headers: Add the following request header:</p>
<ul>
<li>
<p>Accept: &ldquo;application/json;odata=verbose&rdquo;</p>
</li>
<li>
<p>Content-Type: &ldquo;application/json;odata=verbose&rdquo;</p>
</li>
</ul>
</li>
<li>
<p>Uri: [AppWebUrl + &quot;_api/web/lists/GetByTitle(&lsquo;ApprovedVacationRequests')/items&quot;]{.mark}</p>
</li>
<li>
<p>ResponseContent: [CreateListResponseBody]{.mark}</p>
</li>
</ul>
<p>Figure 21: Workflow Model.</p>
<h3></h3>
<h3 id="deploying-the-workflow">Deploying the Workflow<a hidden class="anchor" aria-hidden="true" href="#deploying-the-workflow">#</a></h3>
<p>Now that the workflow is finished we can deploy it to SharePoint. Click F5. Add a new Vacation Request to the list and Click Save.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="//localhost:1313/posts/2014-11-08-connecting-oracle-database-ssis-2008/">
    <span class="title">« Prev</span>
    <br>
    <span>Connecting to an Oracle Database using SSIS 2008</span>
  </a>
  <a class="next" href="//localhost:1313/posts/2014-11-08-sharepoint-2013-workflows-install-configure-workflow-manager-copy/">
    <span class="title">Next »</span>
    <br>
    <span>SharePoint 2013 Workflows Part 2: Installing and Configuring The Workflow Manager</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="//localhost:1313/">sjoukje.eth</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
