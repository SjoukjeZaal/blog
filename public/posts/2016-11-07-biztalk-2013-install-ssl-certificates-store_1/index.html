<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Certificates in BizTalk 2013 Part 1: How To Install SSL Certificates in the Certificate store | sjoukje.eth</title>
<meta name="keywords" content="">
<meta name="description" content="This is the first part in a series on how to use SSL Certificates in your BizTalk Application to secure your data transfer when connecting to third party (web) services. In this post I&rsquo;m going to explain how to install the certificates in the BizTalk servers certificate store.
SSL Certificates
SSL certificates contain a private (.pfx) and a public key (.cer) which will need to be installed in the appropriate certification stores. (For more information on SSL Certificates you can read the following article: http://www.tldp.org/HOWTO/SSL-Certificates-HOWTO/x64.html.)">
<meta name="author" content="sjoukje.eth">
<link rel="canonical" href="/posts/2016-11-07-biztalk-2013-install-ssl-certificates-store_1/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.36f09b336921909a5971cfa84422229fa3edb550fa46b7707cb5436b0983bdcf.css" integrity="sha256-NvCbM2khkJpZcc&#43;oRCIin6PttVD6RrdwfLVDawmDvc8=" rel="preload stylesheet" as="style">
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="/posts/2016-11-07-biztalk-2013-install-ssl-certificates-store_1/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="/posts/2016-11-07-biztalk-2013-install-ssl-certificates-store_1/">
  <meta property="og:site_name" content="sjoukje.eth">
  <meta property="og:title" content="Certificates in BizTalk 2013 Part 1: How To Install SSL Certificates in the Certificate store">
  <meta property="og:description" content="This is the first part in a series on how to use SSL Certificates in your BizTalk Application to secure your data transfer when connecting to third party (web) services. In this post I’m going to explain how to install the certificates in the BizTalk servers certificate store.
SSL Certificates SSL certificates contain a private (.pfx) and a public key (.cer) which will need to be installed in the appropriate certification stores. (For more information on SSL Certificates you can read the following article: http://www.tldp.org/HOWTO/SSL-Certificates-HOWTO/x64.html.)">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2016-11-07T00:00:00+00:00">
    <meta property="article:modified_time" content="2016-11-07T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Certificates in BizTalk 2013 Part 1: How To Install SSL Certificates in the Certificate store">
<meta name="twitter:description" content="This is the first part in a series on how to use SSL Certificates in your BizTalk Application to secure your data transfer when connecting to third party (web) services. In this post I&rsquo;m going to explain how to install the certificates in the BizTalk servers certificate store.
SSL Certificates
SSL certificates contain a private (.pfx) and a public key (.cer) which will need to be installed in the appropriate certification stores. (For more information on SSL Certificates you can read the following article: http://www.tldp.org/HOWTO/SSL-Certificates-HOWTO/x64.html.)">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "/posts/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Certificates in BizTalk 2013 Part 1: How To Install SSL Certificates in the Certificate store",
      "item": "/posts/2016-11-07-biztalk-2013-install-ssl-certificates-store_1/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Certificates in BizTalk 2013 Part 1: How To Install SSL Certificates in the Certificate store",
  "name": "Certificates in BizTalk 2013 Part 1: How To Install SSL Certificates in the Certificate store",
  "description": "This is the first part in a series on how to use SSL Certificates in your BizTalk Application to secure your data transfer when connecting to third party (web) services. In this post I\u0026rsquo;m going to explain how to install the certificates in the BizTalk servers certificate store.\nSSL Certificates SSL certificates contain a private (.pfx) and a public key (.cer) which will need to be installed in the appropriate certification stores. (For more information on SSL Certificates you can read the following article: http://www.tldp.org/HOWTO/SSL-Certificates-HOWTO/x64.html.)\n",
  "keywords": [
    
  ],
  "articleBody": "This is the first part in a series on how to use SSL Certificates in your BizTalk Application to secure your data transfer when connecting to third party (web) services. In this post I’m going to explain how to install the certificates in the BizTalk servers certificate store.\nSSL Certificates SSL certificates contain a private (.pfx) and a public key (.cer) which will need to be installed in the appropriate certification stores. (For more information on SSL Certificates you can read the following article: http://www.tldp.org/HOWTO/SSL-Certificates-HOWTO/x64.html.)\nFor test scenarios you can create your own certificate using the Makecert.exe tool which is part of the .Net Framework. (For production environments SSL certificates need to be purchased from a Certificate Authority (CA).\nBut in the case of using SSL certificates in a BizTalk application, the certificates are probibly provided by the third party to which the application connects to. In that case you can skip the next part and go to the part where the certificates are installed in the appropriate stores.\nCreating SSL Certificates for this demo I’ve used the following article for creating my SSL certificate: http://www.jayway.com/2014/09/03/creating-self-signed-certificates-with-makecert-exe-for-development/http://www.jayway.com/2014/09/03/creating-self-signed-certificates-with-makecert-exe-for-development/\nI’ve made some minor changes to the input paramaters for the Makecert tool. My cmd file consists of the following parameters:\n+———————————–+———————————–+ | 1 | makecert.exe ^ | | | | | 2 | -n \"CN=SjoukjeZaal\" ^ | | | | | 3 | -r ^ | | | | | 4 | -pe ^ | | | | | 5 | -a sha512 ^ | | | | | 6 | -len 4096 ^ | | | | | 7 | -cy authority ^ | | | | | 8 | -sv SjoukjeZaal.pvk ^ | | | | | 9 | SjoukjeZaal.cer | | | | | 10 | pvk2pfx.exe ^ | | | | | 11 | -pvk SjoukjeZaal.pvk ^ | | | | | 12 | -spc SjoukjeZaal.cer ^ | | | | | 13 | -pfx SjoukjeZaal.pfx ^ | | | | | 14 | -po Test123 | +===================================+===================================+\nAfter following the steps from the article the below certificates are created:\nType Description\nsjoukjezaal.cer Root certificate\nsjoukjezaal.pfx Client certificate with private key. (the password for this file is “Test123″). Installing the certificates in the appropriate certificate stores Next is installing the certificates.\nClick Start, click Run and select mmc.exe to open the Microsoft Management Console.\nClick the File Menu and select Add/Remove Snap-in.\nSelect Certificates and click the Add button.\nNow you have to make a selection in which store you want to install the certificates.\n![](./Certificates in BizTalk 2013 Part 1_ How To Install SSL Certificates in the Certificate store/e5ce42b85bf81d0fb357204b9cba67368664e592.png “BizTalk-Certificates-SSL1”){width=“3.125in” height=“2.28125in”}\nThe below table shows in which store to install the SSL certificates so BizTalk can use it to encrypt the messages:\nThe In-Process Host account described in the table below can be obtained by opening the BizTalk Administration Console -\u003e Host Instances and then check under which account the Host-Instance is running. For installing the certificate, log on to the server with the BizTalk Service account, open MMC and choose My User Account.\n+———————————–+————————————————————————–+ | Certificate | Store | +===================================+==========================================================================+ | sjoukjezaal.cer | - Trusted Root CA (Local machine) | | | | | | - Trusted People (Local machine) | | | | | | - Other People (Local machine) | | | | | | - Trusted Publisher (BizTalk Service Account – In-Process Host account) | +———————————–+————————————————————————–+ | sjoukjezaal.pfx | - Personal (local machine) | | | | | | - Personal (Logged in user) | | | | | | - Personal (BizTalk Service Account – In-Process Host account). | +———————————–+————————————————————————–+\nSummary In this article I explained how to install SSL certificates which can be used in your BizTalk Application to make a secure call to a third party (web) service. In the second part of this series I will explain how you can configure the BizTalk Send Port to use the certificates to create a secured channel using the WCF Adapter.\n– Sjoukje\n",
  "wordCount" : "670",
  "inLanguage": "en",
  "datePublished": "2016-11-07T00:00:00Z",
  "dateModified": "2016-11-07T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "sjoukje.eth"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/posts/2016-11-07-biztalk-2013-install-ssl-certificates-store_1/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "sjoukje.eth",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="sjoukje.eth (Alt + H)">sjoukje.eth</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="/books/" title="Books">
                    <span>Books</span>
                </a>
            </li>
            <li>
                <a href="/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="/">Home</a>&nbsp;»&nbsp;<a href="/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Certificates in BizTalk 2013 Part 1: How To Install SSL Certificates in the Certificate store
    </h1>
    <div class="post-meta"><span title='2016-11-07 00:00:00 +0000 UTC'>November 7, 2016</span>&nbsp;·&nbsp;<span>4 min</span>&nbsp;·&nbsp;<span>sjoukje.eth</span>

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#ssl-certificates" aria-label="SSL Certificates">SSL Certificates</a></li>
                <li>
                    <a href="#creating-ssl-certificates" aria-label="Creating SSL Certificates">Creating SSL Certificates</a></li>
                <li>
                    <a href="#sjoukjezaalpfx---------------------client-certificate-with-private-key-the-password-for-this-file-is-test123" aria-label="sjoukjezaal.pfx                     Client certificate with private key. (the password for this file is &ldquo;Test123″).">sjoukjezaal.pfx                     Client certificate with private key. (the password for this file is &ldquo;Test123″).</a></li>
                <li>
                    <a href="#installing-the-certificates-in-the-appropriate-certificate-stores" aria-label="Installing the certificates in the appropriate certificate stores">Installing the certificates in the appropriate certificate stores</a></li>
                <li>
                    <a href="#summary" aria-label="Summary">Summary</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>This is the first part in a series on how to use SSL Certificates in your BizTalk Application to secure your data transfer when connecting to third party (web) services. In this post I&rsquo;m going to explain how to install the certificates in the BizTalk servers certificate store.</p>
<h2 id="ssl-certificates">SSL Certificates<a hidden class="anchor" aria-hidden="true" href="#ssl-certificates">#</a></h2>
<p>SSL certificates contain a private (.pfx) and a public key (.cer) which will need to be installed in the appropriate certification stores. (For more information on SSL Certificates you can read the following article: <a href="http://www.tldp.org/HOWTO/SSL-Certificates-HOWTO/x64.html">http://www.tldp.org/HOWTO/SSL-Certificates-HOWTO/x64.html.)</a></p>
<p>For test scenarios you can create your own certificate using the <a href="http://msdn.microsoft.com/en-us/library/bfsktky3%28v=vs.110%29.aspx">Makecert.exe</a> tool which is part of the .Net Framework. (For production environments SSL certificates need to be purchased from a Certificate Authority (CA).</p>
<p>But in the case of using SSL certificates in a BizTalk application, the certificates are probibly provided by the third party to which the application connects to. In that case you can skip the next part and go to the part where the certificates are installed in the appropriate stores.</p>
<h2 id="creating-ssl-certificates">Creating SSL Certificates<a hidden class="anchor" aria-hidden="true" href="#creating-ssl-certificates">#</a></h2>
<p>for this demo I&rsquo;ve used the following article for creating my SSL certificate: <a href="http://www.jayway.com/2014/09/03/creating-self-signed-certificates-with-makecert-exe-for-development/http://www.jayway.com/2014/09/03/creating-self-signed-certificates-with-makecert-exe-for-development/">http://www.jayway.com/2014/09/03/creating-self-signed-certificates-with-makecert-exe-for-development/http://www.jayway.com/2014/09/03/creating-self-signed-certificates-with-makecert-exe-for-development/</a></p>
<p>I&rsquo;ve made some minor changes to the input paramaters for the Makecert tool. My cmd file consists of the following parameters:</p>
<p>+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| 1                                 | makecert.exe ^                   |
|                                   |                                   |
| 2                                 | -n &quot;CN=SjoukjeZaal&quot; ^          |
|                                   |                                   |
| 3                                 | -r ^                             |
|                                   |                                   |
| 4                                 | -pe ^                            |
|                                   |                                   |
| 5                                 | -a sha512 ^                      |
|                                   |                                   |
| 6                                 | -len 4096 ^                      |
|                                   |                                   |
| 7                                 | -cy authority ^                  |
|                                   |                                   |
| 8                                 | -sv SjoukjeZaal.pvk ^            |
|                                   |                                   |
| 9                                 | SjoukjeZaal.cer                   |
|                                   |                                   |
| 10                                | pvk2pfx.exe ^                    |
|                                   |                                   |
| 11                                | -pvk SjoukjeZaal.pvk ^           |
|                                   |                                   |
| 12                                | -spc SjoukjeZaal.cer ^           |
|                                   |                                   |
| 13                                | -pfx SjoukjeZaal.pfx ^           |
|                                   |                                   |
| 14                                | -po Test123                       |
+===================================+===================================+</p>
<p>After following the steps from the article the below certificates are created:</p>
<hr>
<p><strong>Type</strong>                            <strong>Description</strong></p>
<hr>
<p>sjoukjezaal.cer                     Root certificate</p>
<h2 id="sjoukjezaalpfx---------------------client-certificate-with-private-key-the-password-for-this-file-is-test123">sjoukjezaal.pfx                     Client certificate with private key. (the password for this file is &ldquo;Test123″).<a hidden class="anchor" aria-hidden="true" href="#sjoukjezaalpfx---------------------client-certificate-with-private-key-the-password-for-this-file-is-test123">#</a></h2>
<h2 id="installing-the-certificates-in-the-appropriate-certificate-stores">Installing the certificates in the appropriate certificate stores<a hidden class="anchor" aria-hidden="true" href="#installing-the-certificates-in-the-appropriate-certificate-stores">#</a></h2>
<p>Next is installing the certificates.</p>
<ul>
<li>
<p>Click <strong>Start</strong>, click <strong>Run</strong> and select <strong>mmc.exe</strong> to open the Microsoft Management Console.</p>
</li>
<li>
<p>Click the <strong>File</strong> Menu and select <strong>Add/Remove Snap-in.</strong></p>
</li>
<li>
<p>Select <strong>Certificates</strong> and click the <strong>Add</strong> button.</p>
</li>
<li>
<p>Now you have to make a selection in which store you want to install the certificates.</p>
</li>
</ul>
<p>![](./Certificates in BizTalk 2013 Part 1_ How To Install SSL Certificates in the Certificate store/e5ce42b85bf81d0fb357204b9cba67368664e592.png &ldquo;BizTalk-Certificates-SSL1&rdquo;){width=&ldquo;3.125in&rdquo; height=&ldquo;2.28125in&rdquo;}</p>
<p>The below table shows in which store to install the SSL certificates so BizTalk can use it to encrypt the messages:</p>
<p>The In-Process Host account described in the table below can be obtained by opening the BizTalk Administration Console -&gt; Host Instances and then check under which account the Host-Instance is running. For installing the certificate, log on to the server with the BizTalk Service account, open MMC and choose My User Account.</p>
<p>+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| <strong>Certificate</strong>                   | <strong>Store</strong>                                                                |
+===================================+==========================================================================+
| sjoukjezaal.cer                   | - Trusted Root CA (Local machine)                                        |
|                                   |                                                                          |
|                                   | - Trusted People (Local machine)                                         |
|                                   |                                                                          |
|                                   | - Other People (Local machine)                                           |
|                                   |                                                                          |
|                                   | - Trusted Publisher (BizTalk Service Account &ndash; In-Process Host account) |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| sjoukjezaal.pfx                   | - Personal (local machine)                                               |
|                                   |                                                                          |
|                                   | - Personal (Logged in user)                                              |
|                                   |                                                                          |
|                                   | - Personal (BizTalk Service Account &ndash; In-Process Host account).         |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+</p>
<h2 id="summary">Summary<a hidden class="anchor" aria-hidden="true" href="#summary">#</a></h2>
<p>In this article I explained how to install SSL certificates which can be used in your BizTalk Application to make a secure call to a third party (web) service. In the second part of this series I will explain how you can configure the BizTalk Send Port to use the certificates to create a secured channel using the WCF Adapter.</p>
<p>&ndash; Sjoukje</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="/posts/2016-11-08-sharepoint-2013-workflows/">
    <span class="title">« Prev</span>
    <br>
    <span>SharePoint 2013 Workflows -- Introduction</span>
  </a>
  <a class="next" href="/posts/2015-06-08-azure-app-services/">
    <span class="title">Next »</span>
    <br>
    <span>Azure App Services</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="/">sjoukje.eth</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
